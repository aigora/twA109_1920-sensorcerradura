#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <windows.h>
int Reservar(int F, int C);
int comparador( int x, int y, int **M,int F, int C);
void Imprime(int **I);
int main(int argc, char *argv[]) {
int Alto,Ancho;
int S=0;
int i,j,Estado;
printf("Introduzca cuantas unidades Altura y Anchura desea para el perimetro del experimento \n");
scanf("%d %d",&Alto,&Ancho);
int **Vieja,**Nueva;
// Generacion de la Matriz aleatoria
Nueva = Reservar(Alto,Ancho);
Vieja = Reservar(Alto,Ancho);
srand(time(NULL));
for (i=0;i<Alto;i++){
for(j=0;j<Ancho;j++){
 Vieja[i][j]=0+rand()%(1-0+1);
 if(Vieja[i][j]==1)
 printf("*");
 else{if(Vieja[i][j]==0)
 printf(" ");
 }}
 printf("\n");
}
printf("PULSE ENTER PARA EMPEZAR\n");
system("pause");
while(1){
system("cls");
for (i=0;i<Alto;i++){
for(j=0;j<Ancho;j++){
 S = comparador(i,j,Vieja,Alto,Ancho);
 Estado = Vieja[i][j];
//Cambio a la nueva Matriz
if( Estado==0&&S==3){
Nueva[i][j]=1;
}
else{if(Estado==1&&(S<2||S>3))
Nueva[i][j]=0;
else Nueva[i][j]= Estado;
} 
if(Nueva[i][j] ==1){
printf("*");}                          //No he conseguido hacer una Funcion para imprimir la Matriz Nueva Dinamica
else 
if(Nueva[i][j] ==0) printf(" ");
}
printf("\n");}
Vieja = Nueva;
}
return 0;
}
// Funcion de comparacion de elementos de la Matriz
int comparador( int x, int y, int **M,int F, int C){
int i ,j,fila,colm, suma = 0 ;	
for (i= -1;i<2;i++){
for(j= -1;j<2;j++){	
 fila= (x+i+F)%F;
 colm= (y+j+C)%C;
suma = suma + M[fila][colm];
}}
suma = suma - M[x][y];
return suma;
}
//Funcion para reservar memoria
int Reservar(int F, int C){
int **Matriz,i;
Matriz = (int**)malloc(F*sizeof(int*));
if (Matriz == NULL){printf("No se ha podido reservar espacio de meoria");
exit(1);
}
for(i=0;i<F;i++){
Matriz[i] = (int*)malloc(C*sizeof(int));
if (Matriz[i] == NULL){printf("No se ha podido reservar espacio de meoria");
exit(1);
}}
return Matriz;
}

